Замечания
Для повышения эффективности можно использовать std::atomic<int> вместо shared_ptr<int>.
